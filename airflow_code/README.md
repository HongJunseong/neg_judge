# Neg_judge Pipeline

교통사고 영상으로부터 과실비율을 자동으로 예측하는 End-to-End pipeline입니다.<br>
프레임 추출부터 최종 과실비율 산정까지의 과정을 **Docker** 와 **Apache Airflow**를 활용하여 자동화하였습니다.<br>
Airflow DAG를 통해 데이터 흐름을 제어하고, 실시간 모니터링 가능하게 설계하였습니다.


```bash
│ Stage1 추론 │
├── 영상 → 프레임 추출
│    └── 영상 ID 기반 Stage1 모델 추론
│        └── PF logits 생성 (장소 클래스 예측)
│
│ Stage2 추론 │
├── PF logits + 프레임 → Stage2 모델 추론
│    └── Feature, A/B 진행방향 logits 생성
│
│ Stage3 추론 │
├── Stage1 + Stage2 결과 조합 → Stage3 모델 추론
│    └── 최종 과실비율 (0:100 ~ 100:0) 예측

```

모든 단계는 Airflow DAG으로 연결되어 자동 실행 / 오류 감지 / 재시도가 가능하게 구성되어 있습니다.

이 pipeline은 모델 학습이 아닌, 학습된 모델을 바탕으로 새롭게 입력된 영상에 대한 과실 비율을 예측하는 데에 목적을 두고 있습니다.

## 성능 요약

| 항목 | 내용 |
|:------:|:------:|
|입력 | 교통사고 영상 1건 |
|처리 시간 | 약 14초 (프레임 추출 ~ 최종 예측까지 |
|출력 | 과실 비율 예측 결과 (0:100 ~ 100:0) |
|자동화 수준 | 모델 학습을 제외한 완전 자동화 (Airflow DAG 실행만으로 전체 처리) |


## Version
| Airflow |
|:----:|
| 2.5.1 |
